<!--直达中车辆详情  模态框中的模态框-->
<div id="carDetailModel" class="modal modal-fixed-footer" style="width: 72%;overflow: auto">
    <div class="modal-content center fz20" style="font-weight: 500;padding: 0;">
        <div class="row col s12 vc-center cyan" style="color: white;letter-spacing:1px;font-weight: bold;height: 50px;">
            <p>车辆详情</p>
        </div>
        <div class="row col s12">
            <div class="col s12 fz13" ng-repeat="vinInfo in vinList" ng-if="!(vinList.length == 0)" style="border-bottom: 1px dotted #ccc">
                <div class="col s2 center-align fz22">
                    <i class="mdi mdi-car"></i>
                </div>
                <div class="col s6 left-align">
                    <span>{{vinInfo.vin}}</span>
                </div>
                <div class="col s2 center-align">
                    <span>{{vinInfo.make_name}}</span>
                </div>
                <div class="col s2 center-align">
                    <span>{{vinInfo.ship_name}}</span>
                </div>
            </div>

            <div class="col s12 fz13" ng-if="vinList.length == 0">
                <div class="col s12 center">
                    <span style="letter-spacing: 1px">暂无车辆信息</span>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer vc-center">
        <button class="modal-action modal-close btn waves-light waves-effect cyan lighten-1" type="button" style="margin-left: 56px" >
            确定
        </button>
    </div>
</div>


<!--中转车辆详情  模态框中的模态框-->
<div id="carTDetailModel" class="modal modal-fixed-footer" style="width: 72%;overflow: auto">
    <div class="modal-content center fz20" style="font-weight: 500;padding: 0;">
        <div class="row col s12 vc-center cyan" style="color: white;letter-spacing:1px;font-weight: bold;height: 50px;">
            <p>车辆详情</p>
        </div>
        <div class="row col s12">
            <div class="col s12 fz13" ng-repeat="vinInfo in vinTList" ng-if="!(vinTList.length == 0)" style="border-bottom: 1px dotted #ccc">
                <div class="col s2 center-align fz22">
                    <i class="mdi mdi-car"></i>
                </div>
                <div class="col s6 left-align">
                    <span>{{vinInfo.vin}}</span>
                </div>
                <div class="col s4 center-align">
                    <span>{{vinInfo.make_name}}</span>
                </div>
            </div>

            <div class="col s12 fz13" ng-if="vinTList.length == 0">
                <div class="col s12 center">
                    <span style="letter-spacing: 1px">暂无车辆信息</span>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer vc-center">
        <button class="modal-action modal-close btn waves-light waves-effect cyan lighten-1" type="button" style="margin-left: 56px" >
            确定
        </button>
    </div>
</div>


<!--生成临时路线模态框-->
<div id="temporaryLineMod" class="modal modal-fixed-footer" style="width: 56%;height: 190px">
    <div class="modal-content center fz20" style="font-weight: 500;padding: 0">
        <div class="row col s12 vc-center cyan" style="color: white;letter-spacing:1px;font-weight: bold;height: 50px;">
            <p>创建临时路线</p>
        </div>已用/车位
        <div class="row" style="width: 85%;margin: 0 auto">
            <!--生成路线-->
            <div class="col s12 black-text fz14 center-align" style="padding: 0;">
                <div class="col s4 center-align">
                    <div class="col s6 center-align">
                        <select  id="chooseStartCityMod" name="state" style="width:100%;display: block"  ng-model="startCityInfoMod" ng-change="changeMod(startCityInfoMod)" ng-options="city.city_name  for city in sendCityList" >
                            <option value=""></option>
                        </select>
                    </div>

                    <div class="col s6 center-align">
                        <select id="chooseEndCityMod"  name="state" style="width:100%;display: block;background: #fafafa;border: 1px solid #fafafa;border-bottom: 1px solid #000" ng-model="endCityInfoMod" ng-options="city.city_name + ' ' + city.distance + ' km'   for city in addCityList" >
                            <option value="">目的城市</option>
                        </select>
                    </div>
                </div>
                <div class="col s6">
                    <div class="col s5 right-align" style="padding-top:17px">
                        <p>计划执行时间：</p>
                    </div>
                    <div class="col s7" style="padding: 0">
                        <div class="col s7 input-field" style="margin: 0;padding: 0">
                            <input id="verification_timeM" type="text" class="datepicker" ng-model="lineStartDate" date>
                            <i class="mdi dataIcon mdi-table-large"></i>
                            <label for="verification_timeM">指令时间</label>
                        </div>
                    </div>
                </div>

                <!--取消  保存   发布-->
                <div class="col s2" style="padding-right: 27px">

                    <!--取消-->
                    <div class="col s6 right-align" style="padding: 10px 5px">
                        <a ng-click="hideLineInfo()" style="width: 38px;height: 38px;"
                           class="waves-light waves-effect  red lighten-1 btn btn-floating">
                            <i style="line-height: 39px" class="mdi mdi-close"></i>
                        </a>
                    </div>

                    <!--保存-->
                    <div class="col s6 right-align" style="padding: 10px 5px">
                        <a ng-click="keepLineInfo()" style="width: 38px;height: 38px;"
                           class="waves-light waves-effect cyan lighten-1 btn btn-floating">
                            <i style="line-height: 39px" class="mdi mdi-check"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="instruction_plan">
    <div class="row">
        <!--点击直达路线模态框-->
        <div id="carInfoModel" class="modal modal-fixed-footer" style="width: 72%;overflow: auto">
            <div class="modal-content center fz20" style="font-weight: 500;padding: 0;">
                <div class="row col s12 vc-center cyan" style="font-weight: bold;height: 80px;">
                    <div class="col s3 fz22 white-text" style="font-weight: 600">
                        <p>{{currentModelInfo.date_id}}</p>
                    </div>
                    <div class="col s6 vc-center">
                        <h6 class="white-text fz22" style="font-weight:600">{{currentModelInfo.city_route_start}}&emsp;<span style="font-size: 1.7rem" class="mdi mdi-arrow-right"></span><span>&emsp;{{currentModelInfo.city_route_end}}</span></h6>
                    </div>
                    <div class="col s3 fz22 white-text" style="font-weight: 600">
                        <p>{{currentDistance == "notSet" ? "里程未设置" : currentDistance + " 公里"}}</p>
                    </div>
                </div>
                <div class="row col s12 vc-center" style="width: 94%;margin-left: 3%">
                    <div class="col s12" style="height: 50px;line-height: 50px;border: 1px solid #ccc;background:#dcdfe0 ">
                        <div class="col s6 left-align">
                            <p>发运车商品总数：<span class="cyan-text" style="font-size: 1.8rem">{{currentModelInfo.pre_count}}</span> </p>
                        </div>
                        <div class="col s6 right-align">
                            <p>已安排商品车数：<span style="color: rgb(229,115,115);font-size: 1.8rem">{{transportationCountList}}</span> </p>
                        </div>
                    </div>
                </div>
                <!--模态框内信息卡片-->
                <div class="row col s12" style="width: 94%;margin-left: 3%">
                    <div class="col s6" ng-repeat="transport in transportationList" >
                        <div class="card-panel white "  style="padding: 0">
                            <div class="row white-text setting_shipments_title vc-center" ng-class="{'dis_bgc':transport.demand_status != 1}"
                                 style="padding: 8px;height: 50px;margin-bottom: 12px;background-color:rgb(77,208,225);">
                                <div class="col s12 center fz17">
                                    <p class="col s11"><span >{{transport.addr_name}}</span>&emsp;<span class="mdi mdi-arrow-right"></span>&emsp;<span>{{transport.short_name}}</span></p>
                                    <p class="col s1 right-align vc-center">
                                        <i style="font-size: 1.3rem;" ng-click="showCarDetailModel(transport)"  class="mdi mdi-file-document white-text"></i>
                                    </p>
                                </div>
                            </div>
                            <div class="row fz15" ng-class="{'dis_txt':transport.demand_status != 1}">
                                <div class="col s7" style="margin-bottom: 12px" >
                                    <p>发运车商品总数：<span style="color: rgb(229,115,115)" ng-class="{'dis_txt':transport.demand_status != 1}">{{transport.pre_count}}</span>&nbsp;</p>
                                </div>
                                <div class="col s5" style="margin-bottom: 12px">
                                    <p>已安排：<span style="color: rgb(229,115,115)" ng-class="{'dis_txt':transport.demand_status != 1}">{{transport.plan_count}}</span>&nbsp;</p>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
            <div class="modal-footer vc-center">
                <button class="modal-action modal-close btn waves-light waves-effect cyan lighten-1" type="button" style="margin-left: 56px" >
                    确定
                </button>
            </div>
        </div>

        <!--点击中转路线模态框-->
        <div id="showCarTransferInfoModel" class="modal modal-fixed-footer" style="width: 72%">
            <div class="modal-content center fz20" style="font-weight: 500;padding: 0;">
                <div class="row col s12 vc-center cyan" style="font-weight: bold;height: 80px;">
                    <div class="col s3 fz22 white-text" style="font-weight: 600">
                        <p>{{currentTransferModelInfo.date_id}}</p>
                    </div>
                    <div class="col s6 vc-center">
                        <h6 class="white-text fz22" style="font-weight:600">{{currentTransferModelInfo.transfer_city_name}}&emsp;<span style="font-size: 1.7rem" class="mdi mdi-arrow-right"></span><span>&emsp;{{currentTransferModelInfo.route_end_name}}</span></h6>
                    </div>
                    <div class="col s3 fz22 white-text" style="font-weight: 600">
                        <p>{{currentTransferDistance == "notSet" ? "里程未设置" : currentTransferDistance + " 公里"}}</p>
                    </div>
                </div>
                <div class="row  no-marBottom"  style="width: 94%;margin-left: 3%;margin-bottom: 10px">
                    <div class="col s12" ul-tabs style="overflow: hidden">
                        <ul class="tabWrap white lighten-4">
                            <li class="tab col s6 arrivedStu vc-center" ng-click="arrivedStu()">已到达</li>
                            <li class="tab col s6 arriveStu vc-center" ng-click="arriveStu()">即将到达</li>
                        </ul>
                    </div>
                </div>
                <div id="arrivedStu" class="row tab_box" style="width: 92%;margin-left: 4%">
                    <div class="col s12 vc-center card-panel" style="width: 98%;margin-left:1%;height: 40px;line-height: 40px;background:#dcdfe0">
                        <div class="col s6 left-align">
                            <p>已到达中转站商品车总数 ：<span class="cyan-text" style="font-size: 1.8rem">{{arrivedCarCount}}</span></p>
                        </div>
                        <div class="col s6 right-align">
                            <p>已安排商品车数：<span style="color: rgb(229,115,115);font-size: 1.8rem">{{arriveTransportPlanCount}}</span></p>
                        </div>
                    </div>
                    <div class="col s6" ng-repeat="transport in transportationTransportListStatus7" >
                        <div class="card-panel white" style="padding: 0">
                            <div class="row white-text setting_shipments_title vc-center"  style="padding: 8px;height: 50px;margin-bottom: 20px;background-color:rgb(77,208,225);">
                                <div class="col s12 center fz17">
                                    <p class="col s11"><span >{{transport.transfer_addr_name}}</span>&emsp;<span class="mdi mdi-arrow-right"></span>&emsp;<span>{{transport.short_name}}</span></p>
                                    <p class="col s1 right-align vc-center">
                                        <i style="font-size: 1.3rem;" ng-click="showCarTDetailModel(transport)"  class="mdi mdi-file-document white-text"></i>
                                    </p>
                                </div>
                            </div>
                            <div class="row fz15">
                                <div class="col s4" style="margin-bottom: 12px" >
                                    <p>始发站：{{transport.addr_name}}</p>
                                </div>
                                <div class="col s5" style="margin-bottom: 12px" >
                                    <p>发运商品车总数：<span class="cyan-text">{{transport.arrive_count}}</span>&nbsp</p>
                                </div>
                                <div class="col s3" style="margin-bottom: 12px">
                                    <p>已安排：<span style="color: rgb(229,115,115)">{{transport.plan_count}}</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="arriveStu" class="row tab_box" style="width: 92%;margin-left: 4%">
                    <div class="col s12 vc-center card-panel" style="width: 98%;margin-left: 1%;height: 40px;line-height: 40px;background:#dcdfe0">
                        <div class="col s12 left-align">
                            <p>即将到达中转站商品车总数：<span class="cyan-text" style="font-size: 1.8rem">{{haveArrivedCarCount}}</span></p>
                        </div>
                    </div>
                    <div class="col s6" ng-repeat="transport in transportationTransportListStatus3">
                        <div class="card-panel white"  style="padding: 0">
                            <div class="row white-text setting_shipments_title vc-center" style="padding: 8px;height: 50px;margin-bottom: 20px;background-color:rgb(77,208,225);">
                                <div class="col s12 center fz17">
                                    <p class="col s11"><span >{{transport.transfer_addr_name}}</span>&emsp;<span class="mdi mdi-arrow-right"></span>&emsp;<span>{{transport.short_name}}</span></p>
                                    <p class="col s1 right-align vc-center">
                                        <i style="font-size: 1.3rem;" ng-click="showCarTDetailModel(transport)"  class="mdi mdi-file-document white-text"></i>
                                    </p>
                                </div>
                            </div>
                            <div class="row fz15">
                                <div class="col s6 left-align" style="margin-bottom: 12px;" >
                                    <p>始发站：{{transport.addr_name}}</p>
                                </div>
                                <div class="col s6 right-align" style="margin-bottom: 12px;" >
                                    <p>发运商品车总数：<span class="cyan-text">{{transport.real_count}}</span></p>
                                </div>
                                <div class="col s12 left-align" style="margin-bottom: 12px;">
                                    <p>在途时间：{{transport.load_date| date:'yyyy-MM-dd  HH:mm'}}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer vc-center">
                <button class="modal-action modal-close btn waves-light waves-effect cyan lighten-1" type="button" style="margin-left: 56px" >
                    确定
                </button>
            </div>
        </div>

        <!--修改车辆位置模态框-->
        <div class="row" style="margin: 0">
            <div id="modifyCarPositionMod" class="modal modal-fixed-footer" style="width: 56%;height: 450px">
                <div class="modal-content center fz20" style="font-weight: 500;padding: 0">
                    <div class="row col s12 vc-center cyan" style="color: white;letter-spacing:1px;font-weight: bold;height: 50px;">
                        <p>设置车辆当前位置</p>
                    </div>
                    <div class="row" style="width: 85%;margin: 0 auto">
                        <div class="col s8 offset-s2">
                            <div class="col s12 left-align" style="padding: 0;color: darkgray;font-weight: bold">
                                <div class="col s6" style="padding: 0">
                                    <p><span  style="font-size: 1.6rem" class="mdi mdi-truck cyan-text"></span> {{transportDetails.truck_num}}</p>
                                </div>
                                <div class="col s6" style="padding: 0">
                                    <p><span  style="font-size: 1.6rem" class="mdi mdi-account cyan-text"></span> {{transportDetails.drive_name}}</p>
                                </div>
                            </div>
                            <div class="col s12" style="padding: 0;margin-top: 34px">
                                <select id="car_position" name="car_position" style="width:100%" ng-model="positionCityId">
                                    <option value=""></option>
                                    <option ng-repeat="city in allCityList" ng-value="city.id">{{city.city_name}}</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer valign-wrapper">
                    <div class="col s12">
                        <div class="col s2 offset-s3">
                            <a style="width: 100%" class="modal-action modal-close waves-light waves-effect grey lighten-1 btn">
                                取消
                            </a>
                        </div>
                        <div class="col s2 offset-s2">
                            <a ng-click="modifyCarPosition()" style="width: 100%" class="waves-light waves-effect cyan lighten-1 btn">
                                重置
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!--左栏发运商品车信息卡片-->
        <div class="row col" ul-tabs style="width: 20%">
            <ul class="tabs tabs-fixed-width tab-demo z-depth-1" style="font-size: 25px;font-weight: bold;overflow-x: hidden">
                <li class="tab"><a href="#traightUp" class="cyan-text" >直达</a></li>
                <li class="tab"><a href="#transfer" class="cyan-text" >中转</a></li>
            </ul>

            <!--直发-->
            <div id="traightUp">
                <div class="col input-field s8" style="margin-bottom: 15px">
                    <input id="searchLeftCard" type="text" ng-model="leftKeyWord">
                    <label for="searchLeftCard">起始地/目的地</label>
                </div>
                <div class="col s2 flex flex-round">
                    <i class="mdi mdi-magnify" ng-click="updateLeftCardList()" style="margin:20px 0 0 10px;font-size: 30px;cursor: pointer"></i>
                </div>
                <div class="col s2 flex flex-round left">
                    <i class="mdi mdi-refresh" ng-click="getDeliveryCarInfo()" style="margin:20px 0 0 10px;font-size: 30px;cursor: pointer"></i>
                </div>
                <div class="col s12" ng-repeat="car in newDispatchCarList">
                    <div class="card-panel white " style="padding: 0">
                        <div class="row cyan lighten-2 white-text setting_shipments_title vc-center"
                             style="padding: 10px;height: 42px">
                            <div class="col s12" style="padding: 0;">
                                <h6 class="white-text fz16" style="font-weight:bold;margin: 0">{{car.city_route_start}}&emsp;
                                    <span style="font-size: 1.2rem" class="mdi mdi-arrow-right"></span>
                                    <span>&emsp;{{car.city_route_end}}</span>
                                </h6>
                            </div>

                            <a style="top: 58%;width: 37px;height: 37px;right: 9px"
                               class="right btn-floating setting_shipments_btn  btn waves-effect materialize-red  lighten-2 waves-light vc-center ">
                                <i style="font-size: 1.3rem;line-height: 38px" ng-click="showCarInfoModel(car)"
                                   class="mdi mdi-file-document"></i>
                            </a>
                        </div>
                        <div class="row fz14">
                            <div class="col s12 grey-text">
                                <p style="margin: -5px 0;">{{car.date_id}}</p>
                            </div>
                            <div class="col s5" style="padding-right: 0">
                                <p class="grey-text row " style="padding: 6px 0 8px 0;margin:0">
                                    总发运:
                                    <span style="font-size: 1.2rem;color:rgb(229,115,115);font-weight: bold">{{car.pre_count}}&nbsp;</span>
                                </p>
                            </div>
                            <div class="col s7" style="padding-left: 0">
                                <p class="grey-text row right-align" style="padding: 6px 0 8px 0;margin:0">
                                   中转/已安排:
                                    <span style="font-size: 1.2rem;color:rgb(229,115,115);font-weight: bold">{{car.transfer_count}}/{{car.plan_count}}&nbsp;</span>
                                </p>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <!--中转-->
            <div id="transfer">
                <div class="col input-field s8" style="margin-bottom: 15px">
                    <input id="searchLeftCardTransfer" type="text" ng-model="leftTransferKeyWord">
                    <label for="searchLeftCardTransfer">起始地/目的地</label>
                </div>
                <div class="col s2 flex flex-round">
                    <i class="mdi mdi-magnify" ng-click="updateTransferLeftCardList()" style="margin:20px 0 0 10px;font-size: 30px;cursor: pointer"></i>
                </div>
                <div class="col s2 flex flex-round left">
                    <i class="mdi mdi-refresh" ng-click="getDeliveryCarInfo()" style="margin:20px 0 0 10px;font-size: 30px;cursor: pointer"></i>
                </div>
                <div class="col s12" ng-repeat="car in newTransferDispatchCarList">
                    <div class="card-panel white " style="padding: 0">
                        <div class="row cyan lighten-2 white-text setting_shipments_title vc-center"
                             style="padding: 10px;height: 42px">
                            <div class="col s12" style="padding: 0;">
                                <h6 class="white-text fz16" style="font-weight:bold;margin: 0">{{car.transfer_city_name}}&emsp;
                                    <span style="font-size: 1.2rem" class="mdi mdi-arrow-right"></span>
                                    <span>&emsp;{{car.route_end_name}}</span>
                                </h6>
                            </div>

                            <a style="top: 58%;width: 37px;height: 37px;right: 9px"
                               class="right btn-floating setting_shipments_btn  btn waves-effect materialize-red  lighten-2 waves-light vc-center ">
                                <i style="font-size: 1.3rem;line-height: 38px" ng-click="showCarTransferInfoModel(car)"
                                   class="mdi mdi-file-document"></i>
                            </a>
                        </div>
                        <div class="row fz14">
                            <div class="col s12 grey-text">
                                <p style="margin: -5px 0;">{{car.date_id}}</p>
                            </div>
                            <div class="col s8" style="padding-right: 0">
                                <p class="grey-text row" style="padding: 6px 0 8px 0;margin:0">
                                    即将到达/车辆总数:
                                    <span style="font-size: 1.2rem;color:rgb(229,115,115);font-weight: bold">{{car.transfer_count}}/{{car.pre_count}}&nbsp;</span>
                                </p>
                            </div>
                            <div class="col s4" style="padding-left: 0">
                                <p class="grey-text row right-align" style="padding: 6px 0 8px 0;margin:0">
                                    已安排:
                                    <span style="font-size: 1.2rem;color:rgb(229,115,115);font-weight: bold">{{car.plan_count}}&nbsp;</span>
                                </p>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

        </div>

        <!--中间调度指令-->
        <div class="col" style="width: 60%">
            <div class="col s12" style="margin-bottom: 11px">
                <h5 class="col s12 cyan-text lighten-1 center-align">
                    调度指令<span class="fz15 bold red-text">(待运:{{readyAcceptCount}}&nbsp;&nbsp;&nbsp;在途:{{onRoadCount}})</span>
                </h5>
            </div>
            <div class="row col s12">
                <div class="divider cyan" style="height: 2px"></div>
            </div>
            <!--中间部分信息-->
            <div class="col s12" ng-show="showMiddleCard">
                <!--中间信息卡片-->
                <div class="col s12" style="margin-top: -5px">
                    <div class="card-panel white" style="padding: 0">
                        <div class="row cyan lighten-2 white-text setting_shipments_title vc-center"
                             style="padding: 10px;height: 60px;margin-bottom: 0px">
                            <div class="col s1">
                                <span style="font-size: 2.2rem" class="mdi mdi-truck"></span>
                            </div>
                            <div class="col s3">
                                <p style="font-size: 1.2rem;font-weight: bold;margin: 10px 0">{{dispatchInfo.truck_num}}</p>
                            </div>
                            <div class="col s2">
                                <p style="font-size: 1rem;font-weight: bold;margin: 10px 0">{{dispatchInfo.operate_status}}</p>
                            </div>
                            <div class="col s1 right-align">
                                <span style="font-size: 1.6rem;color: white" class="mdi mdi-map-marker"></span>
                            </div>
                            <div ng-if="!dispatchInfo.city_name == 0" class="col s2 left-align">
                                <p style="font-size: 1.1rem;color: white;margin: 5px 0;line-height: 26px">{{dispatchInfo.city_name}}</p>
                            </div>
                            <div ng-if="dispatchInfo.city_name == 0" class="col s2 left-align">
                                <p>{{dispatchInfo.task_start_name}}
                                    <span class="mdi mdi-arrow-right"></span>
                                    {{dispatchInfo.task_end_name}}
                                </p>
                            </div>
                            <div class="col s1 right-align">
                                <span style="font-size: 1.6rem;color: white" class="mdi mdi-account"></span>
                            </div>
                            <div class="col s2 left-align">
                                <p style="font-size: 1.1rem;color: white;margin: 5px 0;line-height: 26px">{{dispatchInfo.drive_name}}</p>
                            </div>
                        </div>
                        <div class="row cyan lighten-2 white-text fz15">
                            <div class="col s4">
                                <p>所属公司：{{dispatchInfo.company_name}}</p>
                            </div>
                            <div class="col s2">
                                <p>已用/车位：{{dispatchInfo.car_count}}/{{dispatchInfo.truck_number}}</p>
                            </div>
                            <div class="col s2">
                                <p>马力：{{dispatchInfo.hp}}</p>
                            </div>
                            <div class="col s4">
                                <p>电话：{{dispatchInfo.mobile}}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!--往期任务-->
                <div class="col s12">
                    <div class="col s12 z-depth-2" style="padding: 0;margin-bottom: 25px;font-size: 1.1rem;color: darkgray">
                        <div class="col s12" style="height: 55px;background-color: #dcdfe0;font-weight: bold">
                            <div class="col s12 valign-wrapper">
                                <div class="col s12 left-align cyan-text" style="padding: 0;">
                                    <p>往期任务</p>
                                </div>
                            </div>
                        </div>
                        <div class="col s12 wash_fee_details less_mar">
                            <div class="col s12" style="border-bottom: 1px solid darkgray;color: darkgray;font-weight: bold;font-size: 1.05rem" ng-repeat="mission in pastMissionList">
                                <div class="col  center-align" style="width: 40%">
                                    <p>{{mission.id}}&nbsp;&nbsp;&nbsp;{{mission.task_start_date | date:'yyyy-MM-dd'}}&nbsp;&nbsp;<span  class="mdi mdi-arrow-right cyan-text"></span>&nbsp;&nbsp;{{mission.date_id}}</p>
                                </div>
                                <div class="col  center-align"  style="width: 32%">
                                    <p>{{mission.city_route_start}}&nbsp;&nbsp;<span  class="mdi mdi-arrow-right cyan-text"></span>&nbsp;&nbsp;{{mission.city_route_end}}&emsp;{{mission.distance}} 公里</p>
                                </div>
                                <div class="col  center-align"  style="width: 28%">
                                    <p>派发商品车：{{mission.car_count}} 辆&emsp;已完成</p>
                                </div>
                            </div>
                            <div class="col s12" style="border-bottom: 1px solid darkgray;color: darkgray;font-weight: bold;font-size: 1.05rem" ng-show="pastMissionList.length == 0">
                                <div class="col s12 center-align">
                                    <p style="letter-spacing: 2px">暂无往期任务</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!--当前任务-->
                <div class="col s12">
                    <div class="col s12 z-depth-2" style="padding: 0;margin-bottom: 25px;font-size: 1.1rem;color: darkgray">
                        <div class="col s12" style="height: 55px;background-color: #dcdfe0;font-weight: bold">
                            <div class="col s12 valign-wrapper">
                                <div class="col s6 left-align cyan-text" style="padding: 0;">
                                    <p>当前任务</p>
                                </div>
                                <div class="col s3 right-align">
                                    <button ng-click="showCreateTemporaryLine()" style="padding: 0 35px;height: 30px;line-height: 33px;background:#fea353" class="btn waves-light waves-effect lighten-1 fz12" type="button" >
                                        创建临时路线
                                    </button>
                                </div>
                                <div class="col s3 right-align">
                                    <button ng-click="showCreateLine(dispatchInfo.current_city)" style="padding: 0 35px;height: 30px;line-height: 33px" class="btn waves-light waves-effect cyan lighten-1 fz12" type="button">
                                        创建路线
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="col s12 wash_fee_details less_mar" style="padding: 0;">
                            <!--生成路线-->
                            <div class="col s12 black-text fz14 center-align" style="padding: 0;" ng-show="lineInfo">
                                <div class="col s4 center-align">
                                    <div class="col s4 center-align" style="padding: 0">
                                        <select watch material-select id="startSeleCity" name="state" style="width:100%" ng-options="startSeleCity.city_name   for startSeleCity in citySeleList"  ng-change="changeStartSelectCity(startSeleCity)" ng-model="startSeleCity">
                                            <option value=""></option>
                                        </select>
                                    </div>
                                    <div class="col s1 mdi mdi-arrow-right" style="margin-top: 10px"></div>
                                    <div class="col s6">
                                        <select watch material-select id="chooseEndCity" name="state" style="width:100%" ng-options="city.city_name + ' ' + city.distance + ' km'   for city in cityList" ng-model="lineEndCityInfo">
                                            <option value=""></option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col s5">
                                    <div class="col s5 right-align">
                                        <p>计划执行时间：</p>
                                    </div>
                                    <div class="col s7" style="padding: 0">
                                        <div class="col s7 input-field" style="margin: 0;padding: 0">
                                            <input id="verification_time2" type="text" class="datepicker" ng-model="lineStartDate" date>
                                            <i class="mdi dataIcon mdi-table-large"></i>
                                         <!--   <label for="verification_time2">指令时间</label>-->
                                        </div>
                                    </div>
                                </div>

                                <!--取消  保存   发布-->
                                <div class="col s3" style="padding-right: 27px">

                                    <!--取消-->
                                    <div class="col s6 right-align" style="padding: 10px 5px">
                                        <a ng-click="hideLineInfo()" style="width: 38px;height: 38px;"
                                           class="waves-light waves-effect  red lighten-1 btn btn-floating">
                                            <i style="line-height: 39px" class="mdi mdi-close"></i>
                                        </a>
                                    </div>

                                    <!--发布-->
                                    <div class="col s6 center-align" style="padding: 10px 5px">
                                        <a ng-click="confirmChange()" style="width: 38px;height: 38px"
                                           class="waves-light waves-effect cyan lighten-1 btn btn-floating">
                                            <i style="line-height: 39px" class="mdi mdi-check"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>

                            <div class="col s12 center-align" style="padding: 0;font-size: 1rem;color: darkgray;font-weight: bold">
                                <ul class="collapsible" data-collapsible="accordion" style="overflow: hidden;margin: 0;box-shadow: none">
                                    <li ng-repeat="currentLine in currentLineList">
                                        <!--线路列表头-->
                                        <div style="height: 60px;" class="collapsible-header col s12 valign-wrapper collapsible_height" ng-click="showMissionInfo(currentLine.id,currentLine.task_plan_date,currentLine.route_start_id,$index)">
                                            <div class="col s9" style="margin-top: 7px">
                                                <div class="col s7 center-align" style="padding-right: 0">
                                                    <div class="col s5 center-align" style="padding: 0">
                                                        <p style="margin: 0">编号：{{currentLine.id}}</p>
                                                    </div>
                                                    <div class="col s7 center-align" style="padding: 0">
                                                        <p style="margin: 0">{{currentLine.city_route_start}}&emsp;<span class="mdi mdi-arrow-right"></span>&emsp;{{currentLine.city_route_end}}</p>
                                                    </div>
                                                </div>
                                                <div class="col s5">
                                                    <div class="col s6 right-align" style="padding: 0">
                                                        <p style="margin: 0">计划执行时间：</p>
                                                    </div>
                                                    <div class="col s6 left-align" style="padding: 0">
                                                        <p style="margin: 0">{{currentLine.task_plan_date | date:'yyyy-MM-dd'}}</p>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col s2" style="margin-top: 7px">
                                                <div class="col s12 center-align">
                                                    <p style="margin: 0;">{{currentLine.task_status | instructionsStatus}}</p>
                                                </div>
                                            </div>

                                            <div class="col s1" style="margin-top: 5px">
                                                <div class="col s6 center-align" style="padding: 0 5px">
                                                    <a ng-click="deleteLine(currentLine.id,$event)" style="width: 38px;height: 38px"
                                                       class="waves-light waves-effect materialize-red lighten-2 btn btn-floating">
                                                        <i style="line-height: 39px;margin-left: 4px" class="mdi mdi-delete-forever"></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>

                                        <!--拉开的当前任务列表栏,显示任务内容-->
                                        <div class="collapsible-body" style="padding: 0">
                                            <!--tab栏-->
                                            <div class="col s12" ul-tabs style="padding: 0;">
                                                <ul class="tabs tabs-fixed-width tab-demo z-depth-1" style="font-size: 25px;font-weight: bold;overflow-x: hidden">
                                                    <li style="cursor: pointer" class="tab"><a ng-click="showLoadMissionInfo($index)" class="cyan-text">装车任务</a></li>
                                                </ul>
                                            </div>

                                            <!--装车任务-->
                                            <div class="load_mission load_mission{{$index}}" style="font-weight: normal">
                                               <!-- &lt;!&ndash;增加装车任务&ndash;&gt;
                                                <div class="row col s12" ng-show="addMissionBtn">
                                                    <div class="col s3 right-align right" style="padding:15px 0">
                                                        <button ng-click="addMission()" style="width:100%;height: 30px;line-height: 33px"
                                                                class="btn waves-light waves-effect cyan lighten-1 fz12" type="button">
                                                            增加装车任务
                                                        </button>
                                                    </div>
                                                </div>
-->
                                                <!--装车填写信息-->
                                                <div class="col s12 black-text fz14" style="background-color: #e0e0e0;border: 1px solid darkgray;width: 95%;margin: 20px 2.5%">
                                                    <div class="col s12 input-field">
                                                        <select  material-select watch ng-model="selectWhereStart" ng-change="changeWhereStart(selectWhereStart)">
                                                            <option value="" selected disabled>请选择</option>
                                                            <option ng-value="1">始发站出发</option>
                                                            <option ng-value="2">中转站出发</option>
                                                        </select>
                                                    </div>
                                                    <div ng-show="selectWhereStart==1" style="height:350px;">
                                                        <div class="col s4 input-field">
                                                            <select id="chooseLocate" name="chooseLocate" ng-change="cancelDestinationCity()" ng-model="locateId" watch material-select>
                                                                <option value="" selected>装车地点</option>
                                                                <option ng-repeat="locateCity in locateList" ng-value="locateCity">{{locateCity.addr_name}}</option>
                                                            </select>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <select class="destination_city"  style="width: 100%;"  ng-change="getReceiveDistributor(currentLine.id,sendCityId.id,locateId)" ng-model="sendCityId" ng-options="sendCityId.city_name for sendCityId in sendCityList" required>
                                                                <option value=""></option>
                                                            </select>
                                                        </div>
                                                        <div class="col s4">
                                                            <div class="col s10 left-align input-field" ng-show="addrList.length==0">
                                                                <input id="addrListdsdfds" type="text"  ng-model="$parent.receiveInfo" style="margin: 0;" readonly="readonly" >
                                                                <label for="addrListdsdfds">经销商</label>
                                                            </div>
                                                            <div class="col s10 input-field left-align"  ng-show="addrList.length!==0">
                                                                <select class="col s12 chooseDistributor" style="width: 100%;" id="chooseDistributor"  ng-model="$parent.receiveInfo" ng-options="addr.date_id + ' ' + addr.short_name + '&emsp;' + addr.plan_count + '/' + addr.pre_count for addr in addrList">
                                                                    <option value=""></option>
                                                                </select>
                                                            </div>

                                                            <div class="col s2 right-align">
                                                                <i style="font-size: 1.5rem;width: 100%;margin-top: 30px" ng-click="showCarModel(sendCityId.id,locateId)"
                                                                   class="mdi mdi-file-document cyan-text col"></i>
                                                            </div>


                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <input id="load_num" type="number" name="load_num" ng-model="$parent.distributeNum" style="margin: 0;">
                                                            <label for="load_num">装车数量</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <input placeholder="" id="verification_time4" type="text" class="datepicker"
                                                                   ng-model="$parent.lineDate" date>
                                                            <i class="mdi dataIcon mdi-table-large"></i>
                                                            <label for="verification_time4" class="active">计划装车日期</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <input id="verification_time3" type="text" class="timepicker" ng-model="$parent.lineStartTime" time>
                                                            <i class="mdi dataIcon mdi-clock"></i>
                                                            <label for="verification_time3">计划装车时间</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <select material-select watch id="whetherTransfer" ng-change="checkWhetherTransfer(whetherTransfer)" ng-model="whetherTransfer">
                                                                <option value="" selected disabled>请选择</option>
                                                                <option ng-value="0">否</option>
                                                                <option ng-value="1">是</option>
                                                            </select>
                                                            <label for="whetherTransfer">是否中转</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <select class="transfer_city"  style="width: 100%;" ng-change="getTransferCity(transferCityId.id)" ng-model="transferCityId"  ng-options="transferCityId.city_name for transferCityId in sendCityList" ng-disabled="hasTransferType" required>
                                                                <option value=""></option>
                                                            </select>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <select id="transferName" name="transferName"  watch material-select ng-disabled="hasTransferType" ng-model="transferName">
                                                                <option value="">中转站</option>
                                                                <option ng-repeat="transfer in transferCityList" ng-value="transfer">{{transfer.addr_name}}</option>
                                                            </select>
                                                        </div>
                                                        <div class="col s12" style="margin-top: 30px">
                                                            <div class="col s6 offset-s3" style="padding: 0;">
                                                               <!-- <div class="col s5">
                                                                    <a ng-click="closeMissionInfo()" style="width: 100%;background-color: #a0a8b1;" class="waves-light waves-effect lighten-1 btn">
                                                                        取消
                                                                    </a>
                                                                </div>-->
                                                                <div class="col s5 offset-s3">
                                                                    <a ng-click="submitMissionInfo(currentLine.id,sendCityId,locateId,whetherTransfer,transferCityId,transferName,$index)" style="width: 100%;" class="cyan waves-light waves-effect lighten-1 btn">
                                                                        确认
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div ng-show="selectWhereStart==2" style="height:350px;">
                                                        <div class="col s4 input-field">
                                                            <select id="transferChooseLocate" name="chooseLocate" ng-change="changeTransferLocate(ransferLocateId)" ng-model="ransferLocateId" watch material-select>
                                                                <option value="" selected>中转装车地点</option>
                                                                <option ng-repeat="locateCity in locateList" ng-value="locateCity">{{locateCity.addr_name}}</option>
                                                            </select>
                                                        </div>
                                                        <div class="col s8 input-field">
                                                            <select class="col s10" id="originalRoute" name="originalRoute" ng-options="el.demand_route_start +'(' + el.addr_name+ ')' + '--' + el.route_end_name +'(' + el.short_name+ ')' + '&emsp; ' + el.date_id+'&emsp;'+el.plan_count +'/'+el.pre_count for el in transferCityLocateList" ng-model="$parent.originalRoute" watch material-select>
                                                                <option value="" selected>原始路线</option>
                                                            </select>
                                                            <i style="font-size: 1.5rem;margin-top: 6px" ng-click="showCarModelT()"
                                                               class="mdi mdi-file-document cyan-text vc-center col s2"></i>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <input id="load_num2" type="number" name="load_num" ng-model="$parent.distributeNum2" style="margin: 0;">
                                                            <label for="load_num2">装车数量</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <input placeholder="" id="verification_time1" type="text" class="datepicker"
                                                                   ng-model="$parent.lineDate2" date>
                                                            <i class="mdi dataIcon mdi-table-large"></i>
                                                            <label for="verification_time1" class="active">计划装车日期</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <input id="verification_time" type="text" class="timepicker" ng-model="$parent.lineStartTime2" time>
                                                            <i class="mdi dataIcon mdi-clock"></i>
                                                            <label for="verification_time">计划装车时间</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <select material-select watch id="whetherTransfer2" ng-change="checkWhetherTransfer(whetherTransfer2)" ng-model="whetherTransfer2">
                                                                <option value="" selected>请选择</option>
                                                                <option value="0">否</option>
                                                                <option value="1">是</option>
                                                            </select>
                                                            <label for="whetherTransfer2">是否中转</label>
                                                        </div>


                                                        <div class="col s4 input-field">
                                                            <select class="transfer_city2"  style="width: 100%;"  ng-change="getTransferCity(transferCityId2.id)" ng-model="transferCityId2"  ng-options="transferCityId2.city_name for transferCityId2 in sendCityList" ng-disabled="hasTransferType" required>
                                                                <option value=""></option>
                                                            </select>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <select id="transferName2" name="transferName"  watch material-select ng-disabled="hasTransferType2" ng-model="transferName2">
                                                                <option value="">中转站</option>
                                                                <option ng-repeat="transfer in transferCityList" ng-value="transfer">{{transfer.addr_name}}</option>
                                                            </select>
                                                        </div>
                                                        <div class="col s12" style="margin-top: 30px">
                                                            <div class="col s6 offset-s3" style="padding: 0;">
                                                               <!-- <div class="col s5">
                                                                    <a ng-click="closeMissionInfo()" style="width: 100%;background-color: #a0a8b1;" class="waves-light waves-effect lighten-1 btn">
                                                                        取消
                                                                    </a>
                                                                </div>-->
                                                                <div class="col s5 offset-s3">
                                                                    <a ng-click="postMissionInfo(currentLine.id,currentLine.city_route_end,ransferLocateId,whetherTransfer2,transferCityId2,transferName2,originalRoute,$index)" style="width: 100%;" class="waves-light waves-effect lighten-1 btn cyan">
                                                                        确认
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!--装车任务列表-->
                                                <div class="col s12" style="width: 95%;margin: 20px 2.5%;padding: 0;">
                                                    <div class="col s12" style="padding: 0;margin-bottom: 25px;font-size: 1.1rem;color: darkgray">
                                                        <div class="col s12 valign-wrapper" style="height: 42px;background-color: #dcdfe0;font-weight: bold">
                                                            <div class="col s12 valign-wrapper">
                                                                <div class="col s6 left-align" style="color: darkgray;padding: 0;">
                                                                    <p>调度编号：{{taskId}}</p>
                                                                </div>
                                                                <div class="col s6 right-align">
                                                                    <p>指令调度：{{opName}}</p>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col s12 wash_fee_details less_mar" style="padding: 0;">
                                                            <div class="col s12" style="border-bottom: 1px solid darkgray;color: darkgray;font-weight: bold;font-size: 1rem;padding: 0;" ng-repeat="nowMission in missionList">
                                                                <div class="col s12">
                                                                    <div class="col s11 left-align cyan-text">
                                                                        <p ng-show="nowMission.load_task_type==1">
                                                                            {{nowMission.addr_name}}&emsp;<span class="mdi mdi-arrow-right"></span>&emsp;
                                                                            <span ng-show="nowMission.transfer_flag==1">{{nowMission.transfer_addr_name}} <span  class="red-text">(转)</span></span>
                                                                            <span ng-show="nowMission.transfer_flag!==1">{{nowMission.short_name}}</span>
                                                                        <p ng-show="nowMission.load_task_type!==1">
                                                                            {{nowMission.addr_name}}<span  class="red-text">(转)</span>&emsp;<span class="mdi mdi-arrow-right"></span>&emsp;
                                                                        <span ng-show="nowMission.transfer_flag==1">{{nowMission.transfer_addr_name}} <span  class="red-text">(转)</span></span>
                                                                        <span ng-show="nowMission.transfer_flag!==1">{{nowMission.short_name}}</span>
                                                                        </p>
                                                                    </div>
                                                                    <div class="col s1 right-align">
                                                                        <p ng-click="deleteMission(nowMission.id,currentLine.id)" class="red-text mdi mdi-close" style="cursor: pointer;font-size: 1.25rem"></p>
                                                                    </div>
                                                                </div>
                                                                <div class="col s12 fz13" style="margin-bottom: 10px">
                                                                    <div class="col s5 left-align">
                                                                        <p>原始路线:{{nowMission.demand_route_start}}&emsp;<span class="mdi mdi-arrow-right"></span>&emsp;{{nowMission.demand_route_end}}&emsp;{{ "(" + nowMission.short_name + ")"}}</p>
                                                                    </div>
                                                                    <div class="col s3 left-align">
                                                                        <p>{{nowMission.plan_date | date:'yyyy-MM-dd  HH:mm'}}</p>
                                                                    </div>
                                                                    <div class="col s2 left-align">
                                                                        <p>装车数：{{nowMission.real_count}} / {{nowMission.plan_count}}</p>
                                                                    </div>
                                                                    <div class="col s2 right-align">
                                                                        <p>{{nowMission.load_task_status | missionStatus}}</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col s12" style="border-bottom: 1px solid darkgray;color: darkgray;font-weight: bold;font-size: 1.1rem;padding: 0;" ng-show="missionList.length == 0">
                                                                <p style="letter-spacing: 1px">暂无任务信息</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>


                <!--临时任务-->
                <div class="col s12" ng-show="temporaryLineList.length!==0">
                    <div class="col s12 z-depth-2" style="padding: 0;margin-bottom: 25px;font-size: 1.1rem;color: darkgray">
                        <div class="col s12" style="height: 55px;background-color: #dcdfe0;font-weight: bold">
                            <div class="col s12 valign-wrapper">
                                <div class="col s6 left-align cyan-text" style="padding: 0;">
                                    <p>临时任务</p>
                                </div>
                                <div class="col s6"></div>
                            </div>
                        </div>
                        <div class="col s12 wash_fee_details less_mar" style="padding: 0;">

                            <div class="col s12 center-align" style="padding: 0;font-size: 1rem;color: darkgray;font-weight: bold">
                                <ul class="collapsible" data-collapsible="accordion" style="overflow: hidden;margin: 0;box-shadow: none">
                                    <li ng-repeat="temporaryLine in temporaryLineList">
                                        <!--线路列表头-->
                                        <div style="height: 60px;" class="collapsible-header col s12 valign-wrapper collapsible_height" ng-click="showMissionInfo2(temporaryLine.id,temporaryLine.task_plan_date,temporaryLine.route_start_id,$index)">
                                            <div class="col s8" style="margin-top: 7px">
                                                <div class="col s6 center-align" style="padding-right: 0">
                                                    <div class="col s5 center-align" style="padding: 0">
                                                        <p style="margin: 0">编号：{{temporaryLine.id}}</p>
                                                    </div>
                                                    <div class="col s7 center-align" style="padding: 0">
                                                        <p style="margin: 0">{{temporaryLine.city_route_start}}&emsp;<span class="mdi mdi-arrow-right"></span>&emsp;{{temporaryLine.city_route_end}}</p>
                                                    </div>
                                                </div>
                                                <div class="col s6">
                                                    <div class="col s6 right-align" style="padding: 0">
                                                        <p style="margin: 0">计划执行时间：</p>
                                                    </div>
                                                    <div class="col s6 left-align" style="padding: 0">
                                                        <p style="margin: 0">{{temporaryLine.task_plan_date | date:'yyyy-MM-dd'}}</p>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col s2" style="margin-top: 7px">
                                                <div class="col s12 center-align">
                                                    <p style="margin: 0;">{{temporaryLine.task_status | instructionsStatus}}</p>
                                                </div>
                                            </div>

                                            <div class="col s2" style="margin-top: 5px">
                                                <div class="col s6 left-align" style="padding: 0 5px">
                                                    <a ng-click="releaseTmporaryLine(temporaryLine,$event)" style="width: 38px;height: 38px;padding-left: 5px"
                                                       class="waves-light waves-effect materialize-cyan lighten-2 btn btn-floating">
                                                        <i style="line-height: 39px" class="mdi mdi-check"></i>
                                                    </a>
                                                </div>
                                                <div class="col s6 right-align" style="padding: 0 5px">
                                                    <a ng-click="deletetemporaryLine(temporaryLine.id,$event)" style="width: 38px;height: 38px"
                                                       class="waves-light waves-effect materialize-red lighten-2 btn btn-floating">
                                                        <i style="line-height: 39px;margin-left: 4px" class="mdi mdi-delete-forever"></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>


                                        <!--拉开的当前任务列表栏,显示任务内容-->
                                        <div class="collapsible-body" style="padding: 0">
                                            <!--tab栏-->
                                            <div class="col s12" ul-tabs style="padding: 0;">
                                                <ul class="tabs tabs-fixed-width tab-demo z-depth-1" style="font-size: 25px;font-weight: bold;overflow-x: hidden">
                                                    <li style="cursor: pointer" class="tab"><a class="cyan-text" >装车任务</a></li>
                                                </ul>
                                            </div>

                                            <!--装车任务-->
                                            <div class="load_mission load_mission{{$index}}" style="font-weight: normal">

                                                <!--装车填写信息-->
                                                <div class="col s12 black-text fz14" style="background-color: #e0e0e0;border: 1px solid darkgray;width: 95%;margin: 20px 2.5%">
                                                    <div class="col s12 input-field">
                                                        <select  material-select watch ng-model="selectWhereStart" ng-change="changeWhereStart(selectWhereStart)">
                                                            <option value="" selected disabled>请选择</option>
                                                            <option ng-value="1">始发站出发</option>
                                                            <option ng-value="2">中转站出发</option>
                                                        </select>
                                                    </div>
                                                    <div ng-show="selectWhereStart==1" style="height:350px;">
                                                        <div class="col s4 input-field">
                                                            <select id="chooseLocate9" name="chooseLocate" ng-change="cancelDestinationCity()" ng-model="locateId" watch material-select>
                                                                <option value="" selected>装车地点</option>
                                                                <option ng-repeat="locateCity in locateList" ng-value="locateCity">{{locateCity.addr_name}}</option>
                                                            </select>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <select class="destination_city"  style="width: 100%;"  ng-change="getReceiveDistributor(temporaryLine.id,sendCityId.id,locateId)" ng-model="sendCityId" ng-options="sendCityId.city_name for sendCityId in sendCityList" required>
                                                                <option value=""></option>
                                                            </select>
                                                        </div>
                                                        <div class="col s4">
                                                            <div class="col s10 left-align input-field" ng-show="addrList.length==0">
                                                                <input id="addrListdsdfds9"  type="text"  ng-model="$parent.receiveInfo" style="margin: 0;" readonly="readonly" >
                                                                <label for="addrListdsdfds9">经销商</label>
                                                            </div>
                                                            <div class="col s10 input-field left-align"  ng-show="addrList.length!==0">
                                                                <select class="col s12 chooseDistributor9" style="width: 100%;" id="chooseDistributor9"   ng-model="$parent.receiveInfo" ng-options="addr.date_id + ' ' + addr.short_name + '&emsp;' + addr.plan_count + '/' + addr.pre_count for addr in addrList">
                                                                    <option value=""></option>
                                                                </select>
                                                            </div>

                                                            <div class="col s2 right-align">
                                                                <i style="font-size: 1.5rem;width: 100%;margin-top: 30px" ng-click="showCarModel(sendCityId.id,locateId)"
                                                                   class="mdi mdi-file-document cyan-text col"></i>
                                                            </div>
                                                           <!-- <select class="col s10" id="chooseDistributor9" name="chooseDistributor" ng-options="addr.date_id + ' ' + addr.short_name + '&emsp;' + addr.plan_count + '/' + addr.pre_count for addr in addrList" ng-model="$parent.receiveInfo">
                                                                <option value="">经销商</option>
                                                            </select>-->
                                                          <!--  <i style="font-size: 1.5rem;" ng-click="showCarModel(sendCityId.id,locateId)"
                                                               class="mdi mdi-file-document cyan-text vc-center col s2"></i>-->
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <input id="load_num9" type="number" name="load_num" ng-model="$parent.distributeNum" style="margin: 0;">
                                                            <label for="load_num">装车数量</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <input placeholder="" id="verification_time8" type="text" class="datepicker"
                                                                   ng-model="$parent.lineDate" date>
                                                            <i class="mdi dataIcon mdi-table-large"></i>
                                                            <label for="verification_time8" class="active">计划装车日期</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <input id="verification_time9" type="text" class="timepicker" ng-model="$parent.lineStartTime" time>
                                                            <i class="mdi dataIcon mdi-clock"></i>
                                                            <label for="verification_time9">计划装车时间</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <select material-select watch id="whetherTransfer1" ng-change="checkWhetherTransfer(whetherTransfer)" ng-model="whetherTransfer">
                                                                <option value="" selected disabled>请选择</option>
                                                                <option ng-value="0">否</option>
                                                                <option ng-value="1">是</option>
                                                            </select>
                                                            <label for="whetherTransfer">是否中转</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <select class="transfer_city"  style="width: 100%;" ng-change="getTransferCity(transferCityId.id)" ng-model="transferCityId"  ng-options="transferCityId.city_name for transferCityId in sendCityList" ng-disabled="hasTransferType" required>
                                                                <option value=""></option>
                                                            </select>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <select id="transferName9" name="transferName"  watch material-select ng-disabled="hasTransferType" ng-model="transferName">
                                                                <option value="">中转站</option>
                                                                <option ng-repeat="transfer in transferCityList" ng-value="transfer">{{transfer.addr_name}}</option>
                                                            </select>
                                                        </div>
                                                        <div class="col s12" style="margin-top: 30px">
                                                            <div class="col s6 offset-s3" style="padding: 0;">
                                                                <div class="col s5 offset-s3">
                                                                    <a ng-click="submitMissionInfo2(temporaryLine.id,sendCityId,locateId,whetherTransfer,transferCityId,transferName,$index)" style="width: 100%;" class="cyan waves-light waves-effect lighten-1 btn">
                                                                        确认
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div ng-show="selectWhereStart==2" style="height:350px;">
                                                        <div class="col s4 input-field">
                                                            <select id="transferChooseLocate7" name="chooseLocate" ng-change="changeTransferLocate(ransferLocateId)" ng-model="ransferLocateId" watch material-select>
                                                                <option value="" selected>中转装车地点</option>
                                                                <option ng-repeat="locateCity in locateList" ng-value="locateCity">{{locateCity.addr_name}}</option>
                                                            </select>
                                                        </div>
                                                        <div class="col s8 input-field">
                                                            <select class="col s10" id="originalRoute7" name="originalRoute" ng-options="el.demand_route_start +'(' + el.addr_name+ ')' + '--' + el.route_end_name +'(' + el.short_name+ ')' + '&emsp; ' + el.date_id+'&emsp;'+el.plan_count +'/'+el.pre_count for el in transferCityLocateList" ng-model="$parent.originalRoute" watch material-select>
                                                                <option value="" selected>原始路线</option>
                                                            </select>
                                                            <i style="font-size: 1.5rem;margin-top: 6px" ng-click="showCarModelT()"
                                                               class="mdi mdi-file-document cyan-text vc-center col s2"></i>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <input id="load_num7" type="number" name="load_num" ng-model="$parent.distributeNum2" style="margin: 0;">
                                                            <label for="load_num2">装车数量</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <input placeholder="" id="verification_time7" type="text" class="datepicker"
                                                                   ng-model="$parent.lineDate2" date>
                                                            <i class="mdi dataIcon mdi-table-large"></i>
                                                            <label for="verification_time7" class="active">计划装车日期</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <input id="verification_time0" type="text" class="timepicker" ng-model="$parent.lineStartTime2" time>
                                                            <i class="mdi dataIcon mdi-clock"></i>
                                                            <label for="verification_time0">计划装车时间</label>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <select material-select watch id="whetherTransfer7" ng-change="checkWhetherTransfer(whetherTransfer2)" ng-model="whetherTransfer2">
                                                                <option value="" selected>请选择</option>
                                                                <option value="0">否</option>
                                                                <option value="1">是</option>
                                                            </select>
                                                            <label for="whetherTransfer2">是否中转</label>
                                                        </div>


                                                        <div class="col s4 input-field">
                                                            <select class="transfer_city2"  style="width: 100%;"  ng-change="getTransferCity(transferCityId2.id)" ng-model="transferCityId2"  ng-options="transferCityId2.city_name for transferCityId2 in sendCityList" ng-disabled="hasTransferType" required>
                                                                <option value=""></option>
                                                            </select>
                                                        </div>
                                                        <div class="col s4 input-field">
                                                            <select id="transferName7" name="transferName"  watch material-select ng-disabled="hasTransferType2" ng-model="transferName2">
                                                                <option value="">中转站</option>
                                                                <option ng-repeat="transfer in transferCityList" ng-value="transfer">{{transfer.addr_name}}</option>
                                                            </select>
                                                        </div>
                                                        <div class="col s12" style="margin-top: 30px">
                                                            <div class="col s6 offset-s3" style="padding: 0;">
                                                                <!-- <div class="col s5">
                                                                     <a ng-click="closeMissionInfo()" style="width: 100%;background-color: #a0a8b1;" class="waves-light waves-effect lighten-1 btn">
                                                                         取消
                                                                     </a>
                                                                 </div>-->
                                                                <div class="col s5 offset-s3">
                                                                    <a ng-click="postMissionInfo2(temporaryLine.id,temporaryLine.city_route_end,ransferLocateId,whetherTransfer2,transferCityId2,transferName2,originalRoute,$index)" style="width: 100%;" class="waves-light waves-effect lighten-1 btn cyan">
                                                                        确认
                                                                    </a>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <!--装车任务列表-->
                                                <div class="col s12" style="width: 95%;margin: 20px 2.5%;padding: 0;">
                                                    <div class="col s12" style="padding: 0;margin-bottom: 25px;font-size: 1.1rem;color: darkgray">
                                                        <div class="col s12 valign-wrapper" style="height: 42px;background-color: #dcdfe0;font-weight: bold">
                                                           <!-- <div class="col s12 valign-wrapper">
                                                                <div class="col s6 left-align" style="color: darkgray;padding: 0;">
                                                                    <p></p>
                                                                </div>
                                                                <div class="col s6 right-align">
                                                                    <p>指令调度：{{opName}}</p>
                                                                </div>
                                                            </div>-->
                                                        </div>
                                                        <div class="col s12 wash_fee_details less_mar" style="padding: 0;">
                                                            <div class="col s12" style="border-bottom: 1px solid darkgray;color: darkgray;font-weight: bold;font-size: 1rem;padding: 0;" ng-repeat="nowMission in missionList2">
                                                                <div class="col s12">
                                                                    <div class="col s11 left-align cyan-text">
                                                                        <p ng-show="nowMission.load_task_type==1">
                                                                            {{nowMission.addr_name}}&emsp;<span class="mdi mdi-arrow-right"></span>&emsp;
                                                                            <span ng-show="nowMission.transfer_flag==1">{{nowMission.transfer_addr_name}} <span  class="red-text">(转)</span></span>
                                                                            <span ng-show="nowMission.transfer_flag!==1">{{nowMission.short_name}}</span>
                                                                        <p ng-show="nowMission.load_task_type!==1">
                                                                            {{nowMission.addr_name}}<span  class="red-text">(转)</span>&emsp;<span class="mdi mdi-arrow-right"></span>&emsp;
                                                                            <span ng-show="nowMission.transfer_flag==1">{{nowMission.transfer_addr_name}} <span  class="red-text">(转)</span></span>
                                                                            <span ng-show="nowMission.transfer_flag!==1">{{nowMission.short_name}}</span>
                                                                        </p>
                                                                    </div>
                                                                    <div class="col s1 right-align">
                                                                        <p ng-click="deleteMission2(nowMission.id,temporaryLine.id)" class="red-text mdi mdi-close" style="cursor: pointer;font-size: 1.25rem"></p>
                                                                    </div>
                                                                </div>
                                                                <div class="col s12 fz13" style="margin-bottom: 10px">
                                                                    <div class="col s5 left-align">
                                                                        <p>原始路线:{{nowMission.demand_route_start}}&emsp;<span class="mdi mdi-arrow-right"></span>&emsp;{{nowMission.demand_route_end}}&emsp;{{ "(" + nowMission.short_name + ")"}}</p>
                                                                    </div>
                                                                    <div class="col s3 left-align">
                                                                        <p>{{nowMission.plan_date | date:'yyyy-MM-dd  HH:mm'}}</p>
                                                                    </div>
                                                                    <div class="col s2 left-align">
                                                                        <p>装车数：{{nowMission.real_count}} / {{nowMission.plan_count}}</p>
                                                                    </div>
                                                                    <div class="col s2 right-align">
                                                                        <p>{{nowMission.load_task_status | missionStatus}}</p>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col s12" style="border-bottom: 1px solid darkgray;color: darkgray;font-weight: bold;font-size: 1.1rem;padding: 0;" ng-show="missionList2.length == 0">
                                                                <p style="letter-spacing: 1px">暂无任务信息</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>

                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>


            </div>
        </div>

        <!--右边任务指令信息卡片-->
        <div class="col" style="width: 20%">
            <ul class="tabs tabs-fixed-width tab-demo z-depth-1" style="font-size: 25px;font-weight: bold;overflow-x: hidden">
                <li class="tab"><a href="#haveUser" class="cyan-text" >可用</a></li>
                <li class="tab"><a href="#notHaveUser" class="cyan-text" >不可用</a></li>
            </ul>
            <!--可用-->
            <div id="haveUser">
                <!--城市-->
                <div class="col s6">
                    <select id="citySelectOn"  material-select watch  ng-model="citySelect" ng-change="changecitySelect(citySelect,truckNumber)">
                        <option value="">请选择</option>
                        <option ng-repeat="el in cityList" ng-value="el.id">{{el.city_name}}</option>
                    </select>
                </div>
                <!--板位数-->
                <div class="col s6">
                    <select id="truckNumber"  material-select watch  ng-model="truckNumber" ng-change="changeTruckNumber(citySelect,truckNumber)">
                        <option value="">板位数</option>
                        <option ng-repeat="el in truckNumberList" ng-value="el.truck_number">{{el.truck_number}}</option>
                    </select>
                </div>
                <div class="col s4" style="margin-top: 25px">可用车辆</div>
                <div class="col s2 red-text bold fz22 right-align" style="margin-top:20px">{{truckIdCount}}</div>
                <div class="col s4" style="margin-top: 25px">车位总数</div>
                <div class="col s2 red-text bold fz22 right-align" style="margin-top:20px">{{truckNumberCount}}</div>
                <div class="col input-field s8" style="margin-bottom: 15px">
                    <input id="searchRightCard" type="text" ng-model="rightKeyWord">
                    <label for="searchRightCard">车牌/地址/司机</label>
                </div>
                <div class="col s2 flex flex-round">
                    <i class="mdi mdi-magnify" ng-click="updateRightCardList()" style="margin:20px 0 0 10px;font-size: 30px;cursor: pointer"></i>
                </div>
                <div class="col s2 flex flex-round">
                    <i class="mdi mdi-refresh" ng-click="getCarDetails()" style="margin:20px 0 0 10px;font-size: 30px;cursor: pointer"></i>
                </div>

                <div class="col s6" ng-repeat="details in newCarDetailsList">
                    <div class="card-panel white " style="padding: 0;cursor: pointer">
                        <div ng-click="showDispatchInfo(details)" class="row cyan lighten-2 white-text setting_shipments_title vc-center"
                             style="padding: 8px 5px;height: 43px;margin-bottom: 0">
                            <div class="col s9">
                                <p style="font-size: 10px;font-weight: bold;margin: 10px 0">{{details.truck_num}}</p>
                            </div>
                            <div class="col s3 center-align" style="padding: 0;">
                                <p style="font-size: 13px;font-weight: bold;margin: 10px 0">{{details.operate_status}}</p>
                            </div>
                        </div>
                        <div class="row valign-wrapper">
                            <div class="col s12" style="padding: 0">
                                <div class="col s12 valign-wrapper" style="padding: 0">
                                    <div ng-if="!details.current_city == 0" class="col s12 left" style="padding: 0;">
                                        <span ng-click="showModifyCarPositionMod(details)" style="font-size: 15px;color: darkgray" class="mdi mdi-map-marker"></span>
                                        <span style="font-size: 10px;color: black;margin: 5px 0;line-height: 26px">{{details.city_name}}</span>
                                    </div>
                                    <div ng-if="details.current_city == 0" class="col s12 left" style="padding: 0;">
                                        <span ng-click="showModifyCarPositionMod(details)" style="font-size: 15px;color: darkgray" class="mdi mdi-map-marker"></span>
                                        <span style="font-size: 10px;color: black;margin: 5px 0;line-height: 26px">{{details.task_start_name}}
                                            <span class="mdi mdi-arrow-right"></span>
                                            {{details.task_end_name}}
                                        </span>
                                    </div>
                                </div>
                                <div class="col s12 valign-wrapper" style="margin-bottom: 0;padding: 0">
                                    <div class="col s1 vc-center">
                                        <span style="font-size: 13px;color: darkgray" class="mdi mdi-account"></span>
                                    </div>
                                    <div class="col s7 left fz12" style="padding: 0;">
                                        <p style="color: black;margin: 5px 0;line-height: 26px">{{details.drive_name}}</p>
                                    </div>
                                    <div class="col s4 red-text bold center-align" style="padding: 0">{{details.car_count}}/{{details.truck_number}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--不可用-->
            <div id="notHaveUser">
                <div style="margin-top: 20px">
                    <div class="col s6" ng-repeat="details in newCarDetailsList2">
                        <div class="card-panel white " style="padding: 0;cursor: pointer">
                            <div class="row grey lighten-2 white-text setting_shipments_title vc-center"
                                 style="padding: 8px 5px;height: 43px;margin-bottom: 0">
                                <div class="col s9">
                                    <p style="font-size: 10px;font-weight: bold;margin: 10px 0">{{details.truck_num}}</p>
                                </div>
                                <div class="col s3 center-align" style="padding: 0;">
                                </div>
                            </div>
                            <div class="row valign-wrapper">
                                <div class="col s12" style="padding: 0">
                                    <div class="col s12 valign-wrapper" style="padding: 0">
                                        <div ng-if="!details.current_city == 0" class="col s12 left" style="padding: 0;">
                                            <span  style="font-size: 15px;color: darkgray" class="mdi mdi-map-marker"></span>
                                            <span style="font-size: 10px;color: black;margin: 5px 0;line-height: 26px">{{details.city_name}}</span>
                                        </div>
                                        <div ng-if="details.current_city == 0" class="col s12 left" style="padding: 0;">
                                            <span style="font-size: 15px;color: darkgray" class="mdi mdi-map-marker"></span>
                                            <span style="font-size: 10px;color: black;margin: 5px 0;line-height: 26px">未知</span>
                                        </div>
                                    </div>
                                    <div class="col s12 valign-wrapper" style="margin-bottom: 0;padding: 0">
                                        <div class="col s1 vc-center">
                                            <span style="font-size: 13px;color: darkgray" class="mdi mdi-account"></span>
                                        </div>
                                        <div class="col s8 left fz12">
                                            <p style="color: black;margin: 5px 0;line-height: 26px">{{details.drive_name}}</p>
                                        </div>
                                        <div class="col s3 red-text bold">{{details.truck_number==null?0:details.truck_number}}</div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>