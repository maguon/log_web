
<div class="truck_repair_details">
    <div class="storage_storeTitle vc-center ">
        <a class=" storage_goback_btn btn-floating btn waves-effect cyan lighten-1 waves-light " ng-click="return()">
            <i class="mdi mdi-arrow-left-bold"></i>
        </a>
        <h4 class="center-align cyan-text text-lighten-1">维修记录详情</h4>
    </div>
    <div class="divider cyan" style="height: 2px;margin-top: 10px;margin-bottom: 30px"></div>

    <!--维修结束模态框-->
    <div class="row" style="margin: 0">
        <div id="repairFinishMod" class="modal modal-fixed-footer" style="width: 65%;height: 480px">
            <div class="modal-content center fz20" style="font-weight: 500;padding: 0">
                <div class="row col s12 vc-center" style="color: white;letter-spacing:1px;font-weight: bold;height: 50px;background-color:rgb(63,185,193)">
                    <p>维修结束描述</p>
                </div>
                <div class="row col s12" style="margin-top: 15px">
                    <div class="col s8 offset-s2">
                        <div class="col s6 input-field">
                            <select material-select watch id="repairStation" class="truck_type" ng-model="repairStation">
                                <option value="" selected disabled>请选择</option>
                                <option ng-repeat="station in repairStationList" ng-value="station.id">{{station.repair_station_name}}</option>
                            </select>
                            <label for="repairStation"><span style="color: red">* </span>选择维修站</label>
                        </div>
                        <div class="col s6 input-field">
                            <input style="font-size: 1.8rem;text-align: right;color: rgb(230,123,123)" type="number" name="repairMoney" id="repairMoney" ng-model="repairMoney">
                            <label for="repairMoney"><span style="color: red">* </span>维修金额</label>
                        </div>
                    </div>
                </div>
                <div class="row col s12" style="margin-top: 10px">
                    <div class="col s12">
                        <div class="col s8 offset-s2 input-field">
                            <input type="text" name="repairDescription" id="repairDescription" ng-model="repairDescription">
                            <label for="repairDescription"><span style="color: red">* </span>维修描述</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer valign-wrapper">
                <div class="col s12">
                    <div class="col s2 offset-s4">
                        <a style="width: 100%" class="modal-action modal-close waves-light waves-effect grey lighten-1 btn">
                            取消
                        </a>
                    </div>
                    <div class="col s2">
                        <a ng-click="completeRepairInfo()" style="width: 100%" class="waves-light waves-effect cyan lighten-1 btn">
                            确定
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div  class="row col s12" style="width: 75%;margin: 0 auto">
        <!--简短信息-->
        <div class="row col s12 valign-wrapper">
            <div class="col s3 valign-wrapper">
                <div class="col s3 right-align">
                    <span class="white lighten-2 center" style="width:40px;height:40px;font-weight: bold;display:inline-block;border-radius: 100%;font-size: 1.1rem;color: white;background-color: #efb366 !important;line-height: 41px">供</span>
                </div>
                <div class="col s6">
                    <p style="margin: 5px 0;font-weight: bold;font-size: 1.2rem;color: darkgray">{{truckMessage.truck_num}}</p>
                </div>
                <div class="col s3 center" style="padding: 0;">
                    <p style="margin: 5px 0;font-weight: bold;font-size: 1.1rem;color: darkgray">{{truckType == 1 ? "头车" : "挂车"}}</p>
                </div>
            </div>
            <div class="col s6 offset-s3">
                <div class="col s3 valign-wrapper">
                    <div class="col s4 right-align">
                        <span style="color: #26c6da;font-size: 1.6rem" class="mdi mdi-account"></span>
                    </div>
                    <div class="col s8" style="padding: 0;">
                        <span style="font-size: 1.2rem;font-weight: bold;color: darkgray">{{truckMessage.drive_name}}</span>
                    </div>
                </div>
                <div class="col s5 valign-wrapper">
                    <div class="col s4 right-align">
                        <span style="color: #26c6da;font-size: 1.6rem" class="mdi mdi-cellphone-android"></span>
                    </div>
                    <div class="col s8" style="padding: 0;">
                        <span style="font-size: 1.2rem;font-weight: bold;color: darkgray">{{truckMessage.mobile}}</span>
                    </div>
                </div>
                <div class="col s4 valign-wrapper">
                    <div class="col s4 right-align">
                        <span style="color: #26c6da;font-size: 1.6rem" class="mdi mdi-hospital-building"></span>
                    </div>
                    <div class="col s8" style="padding: 0;">
                        <span style="font-size: 1.2rem;font-weight: bold;color: darkgray">{{truckMessage.company_name}}</span>
                    </div>
                </div>
            </div>
        </div>

        <!--未完成维修卡片-->
        <div class="row">
            <div ng-repeat="repairingItem in repairingList" class="row col s12" style="border: 2px solid #26c6da;border-radius: 5px;background-color: white;color: darkgray">
                <!--头-->
                <div class="col s12 card_head valign-wrapper" style="padding: 0;border-bottom: 1px solid #ccc">
                    <div class="col s2">
                        <p class="cyan-text" style="font-weight: bold;">维修编号：{{repairingItem.id}}</p>
                    </div>
                    <div class="col s8">
                        <p style="font-weight: bold;color: darkgray">{{repairingItem.repair_date | date:'yyyy-MM-dd HH:mm:ss'}}</p>
                    </div>
                    <div class="col s2 center-align">
                        <p style="font-weight: bold;color: #e57474;font-size: 1.3rem;margin: 0">正在维修</p>
                    </div>
                </div>
                <!--内容-->
                <div class="col s12 card_body" style="font-size: 1.07rem;padding: 0;margin-top: 10px">
                    <div class="row col s12 valign-wrapper">
                        <div class="col s4 input-field">
                            <select material-select watch id="record_truck_type" class="truck_type" ng-change="isCheckAssociatedAccident(repairingItem)" ng-model="repairingItem.repair_type">
                                <option value="" selected disabled>请选择</option>
                                <option ng-disabled="hasNotAccident" value="1">事故维修</option>
                                <option value="2">非事故维修</option>
                            </select>
                            <label for="record_truck_type">维修类型</label>
                        </div>
                        <div class="col s8">
                            <div class="valign-wrapper" ng-show="repairingItem.repair_type == 1">
                                <div class="col s12 input-field">
                                    <select material-select watch id="associated_accident" class="truck_name" ng-model="repairingItem.accident_id">
                                        <option value="" selected disabled>事故地址</option>
                                        <option ng-repeat="accident in accidentNumList" ng-value="accident.id">{{accident.id + ' - ' + accident.address}}</option>
                                    </select>
                                    <label for="associated_accident"><span style="color: red">* </span>关联事故</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row col s12">
                        <div class="col s12 input-field">
                            <input type="text" name="truck_name" id="repair_reason" ng-model="repairingItem.repair_reason">
                            <label for="repair_reason">维修原因</label>
                        </div>
                    </div>
                </div>
                <!--尾部-->
                <div class="row col s12 card_footer">
                    <div class="col s3 offset-s3 center">
                        <a ng-click="saveRepairInfo(repairingItem)" style="width: 80%" class="waves-light waves-effect cyan lighten-1 btn">
                            保存
                        </a>
                    </div>
                    <div class="col s3 center">
                        <a ng-click="finishRepairInfo(repairingItem.id)" style="width: 80%;background-color: #f0ad4e;" class="waves-light waves-effect lighten-1 btn">
                            维修结束
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!--已完成维修列表-->
        <div class="row" ng-if="repairedList.length !== 0">
            <div class="col s12" style="padding: 0;">
                <ul class="collapsible" data-collapsible="accordion" collapsible>
                    <li ng-repeat="repaired in repairedList">
                        <!--列表头-->
                        <div class="collapsible-header" ng-click="getCurrentDamageImage(damageInfo.id,$index)">
                            <div class="col s4">
                                <p class="cyan-text" style="font-weight: bold;margin: 0">维修编号：{{repaired.id}}</p>
                            </div>
                            <div class="col s8 right-align">
                                <p style="margin: 0;font-weight: bold;color: darkgray;font-size: 1.1rem"><span>{{repaired.repair_date | date:'yyyy-MM-dd HH:mm:ss'}}</span>&emsp;至&emsp;<span>{{repaired.end_date | date:'yyyy-MM-dd HH:mm:ss'}}</span></p>
                            </div>
                        </div>
                        <!--列表内容-->
                        <div class="collapsible-body" style="overflow: hidden">
                            <div class="row">
                                <div class="col s2 valign-wrapper">
                                    <div class="col s4 right-align">
                                        <span style="color: #26c6da;font-size: 1.6rem" class="mdi mdi-file-document"></span>
                                    </div>
                                    <div class="col s8" style="padding: 0;">
                                        <span style="font-size: 1.2rem;font-weight: bold;color: #e57474">{{repaired.repair_type == 1 ? "事故维修" : "非事故维修"}}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col s12">
                                    <p style="color: darkgray;font-size: 1.1rem"><span style="font-weight: bold">维修原因：</span><span>{{repaired.repair_reason}}</span></p>
                                </div>
                                <div class="col s12">
                                    <p style="color: darkgray;font-size: 1.1rem;font-weight: bold"><span>维修站：</span><span>{{repaired.repair_station_name}}</span></p>
                                </div>
                                <div class="col s12">
                                    <p style="color: darkgray;font-size: 1.1rem"><span style="font-weight: bold">维修描述：</span><span>{{repaired.remark}}</span></p>
                                </div>
                            </div>
                            <div class="row" style="margin-bottom: 0">
                                <div class="col s4 offset-s8 right-align">
                                    <p style="font-size: 1.2rem;font-weight: bold;color: darkgray;margin: 0">维修金额：<span style="color: #e57474">{{repaired.repair_money}} </span>元</p>
                                </div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>